<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- PAGE settings -->
  <link rel="icon" href="https://templates.pingendo.com/assets/Pingendo_favicon.ico">
  <title>Historial</title>
  <meta name="description" content="Free Bootstrap 4 Pingendo Aquamarine template for restaurant and food">
  <meta name="keywords" content="Pingendo restaurant food aquamarine free template bootstrap 4">
  <!-- CSS dependencies -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" href="aquamarine.css" type="text/css">
  <!-- Script: Make my navbar transparent when the document is scrolled to top -->
  <script src="js/navbar-ontop.js"></script>
  <!-- Script: Animated entrance -->
  <script src="js/animate-in.js"></script>
</head>

<body onload="cargar()">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-md navbar-dark bg-primary fixed-top">
    <div class="container">
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbar3SupportedContent" aria-controls="navbar3SupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse text-center justify-content-center" id="navbar3SupportedContent">
        <ul class="navbar-nav">
          <li class="nav-item mx-3">
            <a class="nav-link text-light" href="#">
              <img class="d-block img-fluid" src="assets/image/1308159426265.gif" width="90"> </a>
          </li>
          <li class="nav-item my-2">
            <a class="nav-link text-dark" href="index.html">
              <b class="">INICIO
                <br> </b>
            </a>
          </li>
          <li class="nav-item my-2">
            <a class="nav-link" href="https://www.facebook.com/uam.mx/">
              <img class="img-fluid d-block" src="assets/image/facebook.png"> </a>
          </li>
          <li class="nav-item my-2">
            <a class="nav-link" href="https://twitter.com/uam_iztapalapa?lang=es">
              <img class="img-fluid d-block" src="assets/image/twitter.png"> </a>
          </li>
          <li class="nav-item my-2">
            <a class="nav-link" href="https://www.youtube.com/user/UAMVIDEOS">
              <img class="img-fluid d-block" src="assets/image/youtube.png"> </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- Cover -->
  <!-- Intro -->
  <!-- Gallery -->
  <!-- Menu -->
  <!-- Carousel reviews -->
  <!-- Carousel venue -->
  <!-- Events -->
  <!-- Parallax section -->
   <!-- Parallax section -->
  <div class="py-5 photo-overlay section-parallax" id="book" style="background-image: url(&quot;assets/image/presion.jpg&quot;);" >
    <div class="container">
      <div class="row my-5">
        <div class="col-lg-6 mx-auto p-3 animate-in-down">
          <div class="p-4 bg-light inset-shadowed h-75" style="overflow:auto">
            <h4 class="mb-4 text-center">Consultas</h4>
            <table id="presiones" class="table"> </table>
          </div>
        </div>
        <div class="col-md-6 mx-auto p-3">
          <h1 id="nombre" class="bg-primary inset-shadowed text-center"></h1>
          <form class="p-4 bg-light inset-shadowed" method="post" action="https://formspree.io/">
            <h4 class="mb-4 text-center">Promedios</h4>
            <div class="form-group bg-primary text-center">
              <label>
                <b>Presion Sistolica</b>
              </label>
              <input id="pSistolica" class="form-control text-center" placeholder="" disabled=""> </div>
            <br>
            <div class="form-group bg-primary text-center">
              <label>
                <b>Presion Diastolica</b>
              </label>
              <input id="pDiastolica" class="form-control text-center" placeholder="" disabled=""> </div>
          </form>
          <br>
          <a class="btn btn-primary" onclick="regresar()">Regresar</a>
        </div>
      </div>
    </div>
  </div>
  <!-- Footer -->
  <div class="text-center bg-dark pt-5">
    <div class="container">
      <div class="row">
        <div class="col-md-4 p-3">
          <h2 class="mb-4">Contacto</h2>
          <p class="m-0">
            <a href="tel:+246 - 542 550 5462" class="text-white">+246 - 542 550 5462</a>
          </p>
          <p>
            <a href="mailto:info@uam.tsis.com" class="text-white">info@uam.tsis.com</a>
          </p>
        </div>
        <div class="col-md-4 p-3">
          <h2 class="mb-4">Direccion
            <br>
          </h2>
          <p>
            <a href="https://www.google.it/maps" target="blank" class="text-white">23 Fake Street
              <br>U</a>AM Iztapalapa</p>
        </div>
        <div class="col-md-4 p-3">
          <h2 class="mb-4">Horarios
            <br> </h2>
          <p>11:00 - 15:00 &amp; 19:00 - 00:00 Jueves/Viernes&nbsp;
            <br>11:00 - 15:00 &amp; 19:00 - 02:00 Sabado/Domingo</p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12 mt-3">
          <p class="text-center text-muted">Â© Copyright 2018 Pingendo - Vista Creada con Pingendo. </p>
        </div>
      </div>
    </div>
  </div>
  <!-- JavaScript dependencies -->
  <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <!-- Script: Smooth scrolling between anchors in the same page -->
  <script src="js/smooth-scroll.js"></script>
</body>
<script>
	//recupera el paramtro, lo desencripta y lo pasa a JSON
	var usuario = JSON.parse(atob(getParameterByName('data')));
	var xmlhttp = new XMLHttpRequest();
    var pS= usuario.promedioPSintolica;
    var pD= usuario.promedioPDiastolica;
    var cor = usuario.correo;
    var url = "http://localhost:8080/pacientes/"+cor+"/";
    xmlhttp.onreadystatechange=function() {
        if (this.readyState == 4 && this.status == 200) {
        	
        	document.getElementById("pSistolica").value = pS;
        	document.getElementById("pDiastolica").value = pD;
        	cargaTabla(this.responseText);
        }
    }
    xmlhttp.open("GET", url, true);
    xmlhttp.send();
    
    function cargaTabla(response){
		var usu = JSON.parse(response);
		var arr = usu.lecturas
		var i;
		
		var out = "<thead><tr><th class='bg-aquamarine'>Fecha</th><th class='bg-aquamarine'>Presion Sintolica</th><th class='bg-aquamarine'>Presion Diastolica</th></tr></thead><tbody id='t'>";
		for(i = 0; i < arr.length; i++) {
		    out += "<tr><td>" + 
		    (i+1) +
		    "</td><td>" +
		    arr[i].pSintolica +
		    "</td><td>" +
		    arr[i].pDiastolica +
		    "</td></tr>";
		}
		out += "</tbody>";
		document.getElementById("presiones").innerHTML = out;
	}

	function regresar(){
		//encripta el JSON
		var encodedString = btoa(JSON.stringify(usuario));
		//cambia de vista y evia  el JSON encriptado
		window.location.href = 'ControlCuenta.html?data='+encodedString;
	}
	function cargar(){
		document.getElementById("nombre").innerHTML = usuario.nombre + " " + usuario.apellidos;
	}
	//funcion para recuperar el parametro enviado por URL
	function getParameterByName(name, url) {
		if (!url) url = window.location.href;
		name = name.replace(/[\[\]]/g, '\\$&');
		var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),results = regex.exec(url);
		if (!results) return null;
		if (!results[2]) return '';
		return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	</script>
</html>
