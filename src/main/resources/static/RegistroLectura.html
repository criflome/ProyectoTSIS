<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <!-- PAGE settings -->
  <link rel="icon" href="https://templates.pingendo.com/assets/Pingendo_favicon.ico">
  <title>Restaurant Aquamarine - Pingendo template</title>
  <meta name="description" content="Free Bootstrap 4 Pingendo Aquamarine template for restaurant and food">
  <meta name="keywords" content="Pingendo restaurant food aquamarine free template bootstrap 4">
  <!-- CSS dependencies -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" type="text/css">
  <link rel="stylesheet" href="aquamarine.css" type="text/css">
  <!-- Script: Make my navbar transparent when the document is scrolled to top -->
  <script src="js/navbar-ontop.js"></script>
  <!-- Script: Animated entrance -->
  <script src="js/animate-in.js"></script>
  <script>
    var usuario = JSON.parse(atob(getParameterByName('data')));
    function getParameterByName(name, url) {
    	if (!url) url = window.location.href;
    	name = name.replace(/[\[\]]/g, '\\$&');
    	var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),results = regex.exec(url);
    	if (!results) return null;
    	if (!results[2]) return '';
    	return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }
    
    function VentanaLecturas(){
    	var encodedString = btoa(JSON.stringify(usuario));
    	window.location.href = 'RegistroLectura.html?data='+encodedString;
    }
    
    function cargar(){
    	document.getElementById("nombre").innerHTML = "Nombre: " + usuario.nombre + " " + usuario.apellidos;
    	document.getElementById("genero").innerHTML = "Genero: " + usuario.genero;
    	document.getElementById("edad").innerHTML = "Edad: " + usuario.edad;
    }
  </script>
</head>

<body class="" onload="cargar()">
  <!-- Navbar -->
  <nav class="navbar navbar-expand-md navbar-dark bg-primary fixed-top">
    <div class="container">
      <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbar3SupportedContent" aria-controls="navbar3SupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse text-center justify-content-center" id="navbar3SupportedContent">
        <ul class="navbar-nav">
          <li class="nav-item mx-3">
            <a class="nav-link text-light" href="#">
              <img class="d-block img-fluid" src="assets/image/1308159426265.gif" width="90"> </a>
          </li>
          <li class="nav-item my-2">
            <a class="nav-link text-light" href="index.html">
              <b class="">INICIO
                <br> </b>
            </a>
          </li>
          <li class="nav-item my-2">
            <a class="nav-link" href="index.html">
              <b class="my-2 h-50 text-light w-50">CERRAR CESION
                <br> </b>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- Cover -->
  <!-- Intro -->
  <!-- Gallery -->
  <!-- Menu -->
  <!-- Carousel reviews -->
  <!-- Carousel venue -->
  <!-- Events -->
  <!-- Parallax section -->
  <div class="photo-overlay py-5 mx-0" id="book" style="background-image: url(&quot;assets/image/med.jpg&quot;);">
    <div class="container">
      <div class="row my-5">
        <div class="col-md-12">
          <div class="row section-light">
            <div class="col-md-12">
              <h1 id="nombre"></h1>
            </div>
          </div>
          <div class="row section-light">
            <div class="col-md-12">
              <h4>Use este espacio para agregar los datos de su presion arterial, y posteriormente registrarlos</h4>
              <br> </div>
          </div>
          <div class="row section-light">
            <div class="col-md-5">
              <form class="">
                <div class="form-group">
                  <label>Presion Sistolica</label>
                  <input type="number" class="form-control" id="pSistolica"> </div>
                <br>
                <div class="form-group">
                  <label>Presion Diastolica</label>
                  <input type="number" class="form-control" id=pDiastolica> </div>
              </form>
            </div>
            <div class="col-md-5">
              <div class="fecha">
                <label id="diaSemana" class="diaSemana"></label>
                <label id="dia" class="dia"></label>
                <label>de</label>
                <label id="mes" class="mes"></label>
                <label>del</label>
                <label id="anio" class="anio"></label>
              </div>
              <div class="reloj">
                <label id="horas" class="horas"></label>
                <label>:</label>
                <label id="minutos" class="minutos"></label>
                <label>:</label>
                <div class="cajaSegundos">
                  <label id="segundos" class="segundos"></label>
                  <label id="ampm" class="ampm"></label>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="row">
                <div class="col-md-6">
                  <a class="btn btn-primary btn-lg" onclick="RegistraLectura()">Registrar</a>
                </div>
                <div class="col-md-6">
                  <a class="btn btn-primary btn-lg" onclick="regresar()">Regresar</a>
                </div>
              </div>
            </div>
          </div>
          <div class="row section-light">
            <div class="col-md-12">
              <br>
              <br>
              <center>
                <h4>¿Como medir la presion?</h4>
                <iframe src="https://www.youtube.com/embed/Tpaa2olh_74?autoplay=0" height="315" width="420"></iframe>
              </center>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Footer -->
  <div class="text-center bg-dark pt-5">
    <div class="container">
      <div class="row">
        <div class="col-md-4 p-3">
          <h2 class="mb-4">Contacto</h2>
          <p class="m-0">
            <a href="tel:+246 - 542 550 5462" class="text-white">+246 - 542 550 5462</a>
          </p>
          <p>
            <a href="mailto:info@uam.tsis.com" class="text-white">info@uam.tsis.com</a>
          </p>
        </div>
        <div class="col-md-4 p-3">
          <h2 class="mb-4">Direccion
            <br> </h2>
          <p>
            <a href="https://www.google.it/maps" target="blank" class="text-white">23 Fake Street
              <br>U</a>AM Iztapalapa</p>
        </div>
        <div class="col-md-4 p-3">
          <h2 class="mb-4">Horarios
            <br> </h2>
          <p>11:00 - 15:00 &amp; 19:00 - 00:00 Jueves/Viernes&nbsp;
            <br>11:00 - 15:00 &amp; 19:00 - 02:00 Sabado/Domingo</p>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12 mt-3">
          <p class="text-center text-muted">© Copyright 2018 Pingendo - Vista Creada con Pingendo. </p>
        </div>
      </div>
    </div>
  </div>
  <!-- JavaScript dependencies -->
  <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <!-- Script: Smooth scrolling between anchors in the same page -->
  <script src="js/smooth-scroll.js" class="section-dark"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="RegistroLectura.js" type="text/javascript"></script>
</body>
<script>
	//recupera el paramtro, lo desencripta y lo pasa a JSON
	var usuario = JSON.parse(atob(getParameterByName('data')));
	
	function RegistraLectura(){    
	    var xmlhttp = new XMLHttpRequest();
	    var pSistolica=document.getElementById("pSistolica").value;
	    var pDiastolica=document.getElementById("pDiastolica").value;
	    var cor = usuario.correo;
	    var url = "http://localhost:8080/pacientes/"+cor+"/"+pSistolica+"/"+pDiastolica;

	    xmlhttp.onreadystatechange=function() {
	        if (this.readyState == 4 && this.status == 200){
	        	usuario = JSON.parse(this.responseText);
	        	alert("Registro exitoso");
	        	document.getElementById("pSistolica").value = "";
	        	document.getElementById("pDiastolica").value = "";
	        }else{
	        	//alert("no creado");
	        }
	    }
	    xmlhttp.open("POST", url, true);
	    xmlhttp.send();
	}
	function regresar(){
		//encripta el JSON
		var encodedString = btoa(JSON.stringify(usuario));
		//cambia de vista y evia  el JSON encriptado
		window.location.href = 'ControlCuenta.html?data='+encodedString;
	}
	function cargar(){
		document.getElementById("nombre").innerHTML = usuario.nombre + " " + usuario.apellidos;
	}
	//funcion para recuperar el parametro enviado por URL
	function getParameterByName(name, url) {
		if (!url) url = window.location.href;
		name = name.replace(/[\[\]]/g, '\\$&');
		var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),results = regex.exec(url);
		if (!results) return null;
		if (!results[2]) return '';
		return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	</script>
</html>