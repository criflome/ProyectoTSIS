<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<LINK REL=StyleSheet HREF="RegistroLectura.css" TYPE="text/css" MEDIA=screen>
</head>

<body onload="cargar()">
<div class="encabezado">
<h1>Registro lecturas</h1>
<h3>Use este espacio para agregar los datos de su presion arterial, y posteriormente registrarlos</h3>
</div>
<div class="contenedor">
<h1 id="nombre"></h1>
  <div class="widget">
    <div class="fecha">
      <p id="diaSemana" class="diaSemana"></p>
      <p id="dia" class="dia"></p>
      <p>de</p>
      <p id="mes" class="mes"></p>
      <p>del</p>
      <p id="anio" class="anio"></p>
    </div>
    <div class="reloj">
      <p id="horas" class="horas"></p>
      <p>:</p>
      <p id="minutos" class="minutos"></p>
      <p>:</p>
      <div class="cajaSegundos">
        <p id="ampm" class="ampm"></p>
        <p id="segundos" class="segundos"></p>
      </div>
    </div>
  </div>
  <div class="forma">
  Presion Sistolica:<br>
  <input type="text" id="pSistolica">
  <br>
  Presion Diastolica:<br>
  <input type="text" id="pDiastolica">
  <br><br>
  <input type="submit" value="Registrar" onclick="RegistraLectura()">
  <br>
  <input type="submit" value="Regresar" onclick="regresar()">
</div>
  
</div>
<br><br>
<div class="reproductor">
<br><br>
<h5>Como medir la presion?</h5>
<iframe src="https://www.youtube.com/embed/Tpaa2olh_74?autoplay=0" width="420" height="315"></iframe>
</div>

  <script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src="RegistroLectura.js" type="text/javascript"></script>
<script>
	var usuario = JSON.parse(atob(getParameterByName('data')));
	
	function RegistraLectura(){    
	    var xmlhttp = new XMLHttpRequest();
	    var pSistolica=document.getElementById("pSistolica").value;
	    var pDiastolica=document.getElementById("pDiastolica").value;
	    var cor = usuario.correo;
	    var url = "http://localhost:8080/pacientes/"+cor+"/"+pSistolica+"/"+pDiastolica;

	    xmlhttp.onreadystatechange=function() {
	        if (this.readyState == 4 && this.status == 200){
	        	usuario = JSON.parse(this.responseText);
	        	alert("Registro exitoso");
	        	document.getElementById("pSistolica").value = "";
	        	document.getElementById("pDiastolica").value = "";
	        }else{
	        	//alert("no creado");
	        }
	    }
	    xmlhttp.open("POST", url, true);
	    xmlhttp.send();
	}
	function regresar(){
		var encodedString = btoa(JSON.stringify(usuario));
		window.location.href = 'ControlCuenta.html?data='+encodedString;
	}
	function cargar(){
		document.getElementById("nombre").innerHTML = usuario.nombre + " " + usuario.apellidos;
	}
	function getParameterByName(name, url) {
		if (!url) url = window.location.href;
		name = name.replace(/[\[\]]/g, '\\$&');
		var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),results = regex.exec(url);
		if (!results) return null;
		if (!results[2]) return '';
		return decodeURIComponent(results[2].replace(/\+/g, ' '));
	}
	</script>	

</body>


</html>
